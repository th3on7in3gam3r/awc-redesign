generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model attendance {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id       String        @db.Uuid
  service_date  DateTime?     @default(now()) @db.Timestamp(6)
  service_type  String?       @db.VarChar(50)
  check_in_time DateTime?     @default(now()) @db.Timestamp(6)
  created_at    DateTime?     @default(now()) @db.Timestamp(6)
  user_profiles user_profiles @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([user_id], map: "idx_attendance_user_id")
}

model audit_log {
  id               String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  actor_profile_id String?        @db.Uuid
  actor_role       String?        @db.VarChar(50)
  action           String?        @db.VarChar(100)
  entity_type      String?        @db.VarChar(50)
  entity_id        String?        @db.Uuid
  summary          String?
  diff             Json?
  created_at       DateTime?      @default(now()) @db.Timestamp(6)
  user_profiles    user_profiles? @relation(fields: [actor_profile_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model chat_channel_members {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  channel_id    String        @db.Uuid
  person_id     String        @db.Uuid
  role          String?       @default("member") @db.VarChar(50)
  joined_at     DateTime?     @default(now()) @db.Timestamp(6)
  last_read_at  DateTime?     @default(now()) @db.Timestamp(6)
  chat_channels chat_channels @relation(fields: [channel_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([channel_id, person_id])
}

model chat_channels {
  id                   String                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name                 String                 @db.VarChar(100)
  type                 String                 @default("general") @db.VarChar(50)
  description          String?
  created_by           String?                @db.Uuid
  created_at           DateTime?              @default(now()) @db.Timestamp(6)
  updated_at           DateTime?              @default(now()) @db.Timestamp(6)
  ministry_id          String?                @db.Uuid
  is_active            Boolean?               @default(true)
  is_staff_only        Boolean?               @default(false)
  chat_channel_members chat_channel_members[]
  ministries           ministries?            @relation(fields: [ministry_id], references: [id], onUpdate: NoAction)
  chat_messages        chat_messages[]
  chat_reads           chat_reads[]
}

model chat_messages {
  id               String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  channel_id       String        @db.Uuid
  sender_person_id String        @db.Uuid
  message_text     String
  created_at       DateTime?     @default(now()) @db.Timestamp(6)
  attachment_url   String?
  attachment_type  String?       @db.VarChar(50)
  chat_channels    chat_channels @relation(fields: [channel_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model chat_reads {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  channel_id    String        @db.Uuid
  user_id       String        @db.Uuid
  last_read_at  DateTime?     @default(now()) @db.Timestamp(6)
  chat_channels chat_channels @relation(fields: [channel_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([channel_id, user_id])
}

model checkins {
  id             String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  session_id     String?        @db.Uuid
  event_id       String?        @db.Uuid
  user_id        String?        @db.Uuid
  guest_name     String?        @db.VarChar(100)
  guest_phone    String?        @db.VarChar(20)
  guest_email    String?        @db.VarChar(100)
  adults         Int?           @default(1)
  children       Int?           @default(0)
  first_time     Boolean?       @default(false)
  contact_ok     Boolean?       @default(true)
  type           String?        @default("member") @db.VarChar(20)
  prayer_request String?
  created_at     DateTime?      @default(now()) @db.Timestamp(6)
  user_profiles  user_profiles? @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model children {
  id                       String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  parent_user_id           String?             @db.Uuid
  first_name               String?             @db.VarChar(50)
  last_name                String?             @db.VarChar(50)
  dob                      DateTime?           @db.Date
  allergies                String?
  notes                    String?
  created_at               DateTime?           @default(now()) @db.Timestamp(6)
  authorized_pickup_names  String?
  media_consent_status     String?             @default("unset") @db.VarChar(50)
  media_consent_updated_at DateTime?           @db.Timestamp(6)
  user_profiles            user_profiles?      @relation(fields: [parent_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  media_consent_log        media_consent_log[]
  program_checkins         program_checkins[]
}

model event_bookings {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  event_id    String?    @db.Uuid
  resource_id String?    @db.Uuid
  created_at  DateTime?  @default(now()) @db.Timestamp(6)
  events      events?    @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  resources   resources? @relation(fields: [resource_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([event_id, resource_id])
}

model event_sessions {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  event_id   String?   @db.Uuid
  code       String    @db.VarChar(20)
  status     String?   @default("active") @db.VarChar(20)
  started_at DateTime? @default(now()) @db.Timestamp(6)
  ended_at   DateTime? @db.Timestamp(6)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  events     events?   @relation(fields: [event_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model events {
  id                                                         String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title                                                      String           @db.VarChar(255)
  description                                                String?
  starts_at                                                  DateTime         @db.Timestamp(6)
  location                                                   String?          @db.VarChar(255)
  created_by                                                 String?          @db.Uuid
  status                                                     String?          @default("pending") @db.VarChar(50)
  created_at                                                 DateTime?        @default(now()) @db.Timestamp(6)
  updated_at                                                 DateTime?        @default(now()) @db.Timestamp(6)
  requested_by_person_id                                     String?          @db.Uuid
  ends_at                                                    DateTime?        @db.Timestamp(6)
  ministry_id                                                String?          @db.Uuid
  event_bookings                                             event_bookings[]
  event_sessions                                             event_sessions[]
  user_profiles_events_created_byTouser_profiles             user_profiles?   @relation("events_created_byTouser_profiles", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_profiles_events_requested_by_person_idTouser_profiles user_profiles?   @relation("events_requested_by_person_idTouser_profiles", fields: [requested_by_person_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model finance_entries {
  id                   String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  entry_date           DateTime         @db.Date
  amount               Decimal          @db.Decimal(10, 2)
  category             String?          @db.VarChar(100)
  memo                 String?
  created_by_person_id String?          @db.Uuid
  created_at           DateTime?        @default(now()) @db.Timestamp(6)
  fund_id              String?          @db.Uuid
  source_id            String?          @db.Uuid
  user_profiles        user_profiles?   @relation(fields: [created_by_person_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "finance_entries_created_by_fkey")
  finance_funds        finance_funds?   @relation(fields: [fund_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  finance_sources      finance_sources? @relation(fields: [source_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model finance_funds {
  id              String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name            String            @unique @db.VarChar(100)
  is_active       Boolean?          @default(true)
  created_at      DateTime?         @default(now()) @db.Timestamp(6)
  updated_at      DateTime?         @default(now()) @db.Timestamp(6)
  finance_entries finance_entries[]
}

model finance_sources {
  id              String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name            String            @unique @db.VarChar(100)
  is_active       Boolean?          @default(true)
  created_at      DateTime?         @default(now()) @db.Timestamp(6)
  updated_at      DateTime?         @default(now()) @db.Timestamp(6)
  finance_entries finance_entries[]
}

model giving_content {
  key        String    @id @db.VarChar(100)
  value      String?
  updated_at DateTime? @default(now()) @db.Timestamp(6)
}

model giving_intents {
  id               String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id          String?         @db.Uuid
  amount           Decimal?        @db.Decimal(10, 2)
  fund             String?         @db.VarChar(50)
  created_at       DateTime?       @default(now()) @db.Timestamp(6)
  giving_option_id String?         @db.Uuid
  frequency        String?         @db.VarChar(50)
  status           String?         @default("pending") @db.VarChar(50)
  updated_at       DateTime?       @default(now()) @db.Timestamp(6)
  giving_options   giving_options? @relation(fields: [giving_option_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_profiles    user_profiles?  @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model giving_options {
  id             String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title          String           @db.VarChar(100)
  provider       String?          @db.VarChar(50)
  category       String?          @db.VarChar(50)
  url            String?          @db.VarChar(255)
  handle         String?          @db.VarChar(100)
  subtitle       String?          @db.VarChar(255)
  is_primary     Boolean?         @default(false)
  is_active      Boolean?         @default(true)
  sort_order     Int?             @default(0)
  created_at     DateTime?        @default(now()) @db.Timestamp(6)
  updated_at     DateTime?        @default(now()) @db.Timestamp(6)
  giving_intents giving_intents[]
}

model holds {
  id                      String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  type                    String         @db.VarChar(50)
  requested_by_profile_id String?        @db.Uuid
  target_date             DateTime?      @db.Date
  target_resource         String?        @db.VarChar(100)
  notes                   String?
  status                  String?        @default("PENDING") @db.VarChar(20)
  created_at              DateTime?      @default(now()) @db.Timestamp(6)
  updated_at              DateTime?      @default(now()) @db.Timestamp(6)
  user_profiles           user_profiles? @relation(fields: [requested_by_profile_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model household_members {
  id                 String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  household_id       String?     @db.Uuid
  person_id          String?     @db.Uuid
  relationship       String?     @db.VarChar(50)
  is_head            Boolean?    @default(false)
  is_primary_contact Boolean?    @default(false)
  created_at         DateTime?   @default(now()) @db.Timestamp(6)
  updated_at         DateTime?   @default(now()) @db.Timestamp(6)
  households         households? @relation(fields: [household_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  people             people?     @relation(fields: [person_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([household_id, person_id])
}

model households {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  household_name    String              @db.VarChar(255)
  address_line1     String?
  city              String?             @db.VarChar(100)
  state             String?             @db.VarChar(50)
  zip               String?             @db.VarChar(10)
  primary_phone     String?             @db.VarChar(20)
  created_at        DateTime?           @default(now()) @db.Timestamp(6)
  updated_at        DateTime?           @default(now()) @db.Timestamp(6)
  address_line2     String?             @db.VarChar(255)
  primary_email     String?             @db.VarChar(255)
  household_members household_members[]
}

model login_history {
  id            String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id       String?        @db.Uuid
  ip_address    String?        @db.VarChar(45)
  user_agent    String?
  success       Boolean?       @default(true)
  created_at    DateTime?      @default(now()) @db.Timestamp(6)
  location      String?        @db.VarChar(150)
  user_profiles user_profiles? @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "login_history_profile_id_fkey")
}

model media_consent {
  id             String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id        String        @db.Uuid
  consent_status String        @db.VarChar(50)
  child_ids      String[]      @db.Uuid
  signature      String?
  signed_at      DateTime?     @default(now()) @db.Timestamp(6)
  created_at     DateTime?     @default(now()) @db.Timestamp(6)
  updated_at     DateTime?     @default(now()) @db.Timestamp(6)
  user_profiles  user_profiles @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model media_consent_log {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  profile_id    String        @db.Uuid
  child_id      String?       @db.Uuid
  status        String        @db.VarChar(50)
  source        String?       @db.VarChar(50)
  ip_hash       String?
  user_agent    String?
  created_at    DateTime?     @default(now()) @db.Timestamp(6)
  children      children?     @relation(fields: [child_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_profiles user_profiles @relation(fields: [profile_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model ministries {
  id               String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name             String             @db.VarChar(255)
  description      String?
  is_active        Boolean?           @default(true)
  created_at       DateTime?          @default(now()) @db.Timestamp(6)
  updated_at       DateTime?          @default(now()) @db.Timestamp(6)
  chat_channels    chat_channels[]
  ministry_members ministry_members[]
  user_ministries  user_ministries[]
}

model ministry_members {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  ministry_id String?     @db.Uuid
  person_id   String?     @db.Uuid
  role        String?     @default("member") @db.VarChar(50)
  joined_at   DateTime?   @default(now()) @db.Timestamp(6)
  status      String?     @default("active") @db.VarChar(20)
  ministries  ministries? @relation(fields: [ministry_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  people      people?     @relation(fields: [person_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([ministry_id, person_id])
}

model ministry_requests {
  id            String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  ministry_name String?        @db.VarChar(100)
  user_id       String?        @db.Uuid
  status        String?        @default("pending") @db.VarChar(50)
  created_at    DateTime?      @default(now()) @db.Timestamp(6)
  updated_at    DateTime?      @default(now()) @db.Timestamp(6)
  user_profiles user_profiles? @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model notification_preferences {
  id                    String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id               String?        @unique(map: "notification_preferences_profile_id_key") @db.Uuid
  email_enabled         Boolean?       @default(true)
  push_enabled          Boolean?       @default(true)
  sms_enabled           Boolean?       @default(false)
  created_at            DateTime?      @default(now()) @db.Timestamp(6)
  updated_at            DateTime?      @default(now()) @db.Timestamp(6)
  email_events          Boolean?       @default(true)
  email_ministry        Boolean?       @default(true)
  email_prayer          Boolean?       @default(true)
  email_chat            Boolean?       @default(true)
  email_system          Boolean?       @default(true)
  push_chat             Boolean?       @default(true)
  push_mentions         Boolean?       @default(true)
  push_events           Boolean?       @default(true)
  push_prayer           Boolean?       @default(true)
  sms_emergency         Boolean?       @default(true)
  sms_events            Boolean?       @default(false)
  sms_prayer            Boolean?       @default(false)
  sound_enabled         Boolean?       @default(true)
  desktop_notifications Boolean?       @default(true)
  badge_counts          Boolean?       @default(true)
  user_profiles         user_profiles? @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "notification_preferences_profile_id_fkey")
}

model notifications {
  id                   String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  recipient_profile_id String?        @db.Uuid
  type                 String         @db.VarChar(50)
  title                String         @db.VarChar(255)
  body                 String?
  href                 String?        @db.VarChar(500)
  is_read              Boolean?       @default(false)
  created_at           DateTime?      @default(now()) @db.Timestamp(6)
  user_profiles        user_profiles? @relation(fields: [recipient_profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "notifications_profile_id_fkey")
}

model onboarding_progress {
  id                 String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id            String        @unique @db.Uuid
  current_step       Int?          @default(1)
  completed          Boolean?      @default(false)
  ministry_interests String[]
  created_at         DateTime?     @default(now()) @db.Timestamp(6)
  updated_at         DateTime?     @default(now()) @db.Timestamp(6)
  completed_at       DateTime?     @db.Timestamp(6)
  user_profiles      user_profiles @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model people {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  first_name        String              @db.VarChar(100)
  last_name         String              @db.VarChar(100)
  email             String?             @db.VarChar(255)
  phone             String?             @db.VarChar(20)
  date_of_birth     DateTime?           @db.Date
  gender            String?             @db.VarChar(20)
  address           String?
  city              String?             @db.VarChar(100)
  state             String?             @db.VarChar(50)
  zip               String?             @db.VarChar(10)
  avatar            String?
  created_at        DateTime?           @default(now()) @db.Timestamp(6)
  updated_at        DateTime?           @default(now()) @db.Timestamp(6)
  household_members household_members[]
  ministry_members  ministry_members[]
  user_profiles     user_profiles?
}

model posts {
  id         String    @id
  title      String
  content    String
  excerpt    String?
  author     String?
  date       String
  read_time  String?
  image_url  String?
  tags       String[]
  likes      Int?      @default(0)
  views      Int?      @default(0)
  is_draft   Boolean?  @default(false)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
}

model prayer_requests {
  id            String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id       String?        @db.Uuid
  request_text  String
  is_anonymous  Boolean?       @default(false)
  is_private    Boolean?       @default(false)
  status        String?        @default("open") @db.VarChar(20)
  created_at    DateTime?      @default(now()) @db.Timestamp(6)
  user_profiles user_profiles? @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model program_checkins {
  id                                                           String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  session_id                                                   String?           @db.Uuid
  child_id                                                     String?           @db.Uuid
  parent_user_id                                               String?           @db.Uuid
  teen_user_id                                                 String?           @db.Uuid
  program                                                      String?           @db.VarChar(50)
  pickup_code                                                  String?           @db.VarChar(10)
  picked_up_at                                                 DateTime?         @db.Timestamp(6)
  picked_up_by                                                 String?           @db.VarChar(100)
  emergency_contact_name                                       String?           @db.VarChar(100)
  emergency_contact_phone                                      String?           @db.VarChar(20)
  notes                                                        String?
  created_at                                                   DateTime?         @default(now()) @db.Timestamp(6)
  checked_in_at                                                DateTime?         @default(now()) @db.Timestamp(6)
  children                                                     children?         @relation(fields: [child_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_profiles_program_checkins_parent_user_idTouser_profiles user_profiles?    @relation("program_checkins_parent_user_idTouser_profiles", fields: [parent_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  program_sessions                                             program_sessions? @relation(fields: [session_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_profiles_program_checkins_teen_user_idTouser_profiles   user_profiles?    @relation("program_checkins_teen_user_idTouser_profiles", fields: [teen_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model program_sessions {
  id                                                      String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  service_date                                            DateTime?          @db.Date
  program                                                 String?            @db.VarChar(50)
  is_active                                               Boolean?           @default(true)
  created_at                                              DateTime?          @default(now()) @db.Timestamp(6)
  status                                                  String?            @default("active") @db.VarChar(50)
  opened_at                                               DateTime?          @default(now()) @db.Timestamp(6)
  opened_by                                               String?            @db.Uuid
  closed_by                                               String?            @db.Uuid
  closed_at                                               DateTime?          @db.Timestamp(6)
  program_checkins                                        program_checkins[]
  user_profiles_program_sessions_closed_byTouser_profiles user_profiles?     @relation("program_sessions_closed_byTouser_profiles", fields: [closed_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_profiles_program_sessions_opened_byTouser_profiles user_profiles?     @relation("program_sessions_opened_byTouser_profiles", fields: [opened_by], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([program, service_date], map: "program_sessions_program_date_key")
}

model resources {
  id             String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name           String           @unique @db.VarChar(100)
  capacity       Int?             @default(0)
  is_active      Boolean?         @default(true)
  created_at     DateTime?        @default(now()) @db.Timestamp(6)
  updated_at     DateTime?        @default(now()) @db.Timestamp(6)
  event_bookings event_bookings[]
}

model sermons {
  id            String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title         String    @db.VarChar(255)
  scripture     String?   @db.VarChar(255)
  speaker       String?   @db.VarChar(255)
  type          String?   @default("sunday_service") @db.VarChar(50)
  series        String?   @db.VarChar(255)
  description   String?
  video_url     String?
  thumbnail_url String?
  preached_at   DateTime  @db.Timestamp(6)
  is_published  Boolean?  @default(false)
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  updated_at    DateTime? @default(now()) @db.Timestamp(6)
}

model user_ministries {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id       String        @db.Uuid
  ministry_id   String        @db.Uuid
  role          String?       @default("member") @db.VarChar(50)
  joined_at     DateTime?     @default(now()) @db.Timestamp(6)
  ministries    ministries    @relation(fields: [ministry_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_profiles user_profiles @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([user_id, ministry_id])
}

model user_notes {
  id                                                 String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id                                            String         @db.Uuid
  note                                               String
  created_by                                         String?        @db.Uuid
  created_at                                         DateTime?      @default(now()) @db.Timestamp(6)
  user_profiles_user_notes_created_byTouser_profiles user_profiles? @relation("user_notes_created_byTouser_profiles", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_profiles_user_notes_user_idTouser_profiles    user_profiles  @relation("user_notes_user_idTouser_profiles", fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model user_profiles {
  id                                                              String                    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  person_id                                                       String?                   @unique @db.Uuid
  email                                                           String                    @unique @db.VarChar(255)
  password_hash                                                   String
  username                                                        String?                   @unique @db.VarChar(50)
  username_lower                                                  String?                   @unique @db.VarChar(50)
  role                                                            String?                   @default("member") @db.VarChar(50)
  is_active                                                       Boolean?                  @default(true)
  last_login                                                      DateTime?                 @db.Timestamp(6)
  created_at                                                      DateTime?                 @default(now()) @db.Timestamp(6)
  updated_at                                                      DateTime?                 @default(now()) @db.Timestamp(6)
  first_name                                                      String?                   @db.VarChar(100)
  last_name                                                       String?                   @db.VarChar(100)
  phone                                                           String?                   @db.VarChar(20)
  avatar                                                          String?                   @db.VarChar(255)
  person_type                                                     String?                   @default("adult") @db.VarChar(20)
  membership_status                                               String?                   @default("visitor") @db.VarChar(50)
  media_consent_status                                            String?                   @default("unset") @db.VarChar(20)
  media_consent_updated_at                                        DateTime?                 @db.Timestamp(6)
  media_consent_source                                            String?                   @db.VarChar(50)
  tags                                                            String[]
  notes                                                           String?
  date_of_birth                                                   DateTime?                 @db.Date
  ministry_interests                                              String[]
  birthday                                                        DateTime?                 @db.Date
  address                                                         String?
  profile_photo_url                                               String?
  email_notifications                                             Boolean?                  @default(true)
  sms_notifications                                               Boolean?                  @default(true)
  media_consent_notes                                             String?
  attendance                                                      attendance[]
  audit_log                                                       audit_log[]
  checkins                                                        checkins[]
  children                                                        children[]
  events_events_created_byTouser_profiles                         events[]                  @relation("events_created_byTouser_profiles")
  events_events_requested_by_person_idTouser_profiles             events[]                  @relation("events_requested_by_person_idTouser_profiles")
  finance_entries                                                 finance_entries[]
  giving_intents                                                  giving_intents[]
  holds                                                           holds[]
  login_history                                                   login_history[]
  media_consent                                                   media_consent[]
  media_consent_log                                               media_consent_log[]
  ministry_requests                                               ministry_requests[]
  notification_preferences                                        notification_preferences?
  notifications                                                   notifications[]
  onboarding_progress                                             onboarding_progress?
  prayer_requests                                                 prayer_requests[]
  program_checkins_program_checkins_parent_user_idTouser_profiles program_checkins[]        @relation("program_checkins_parent_user_idTouser_profiles")
  program_checkins_program_checkins_teen_user_idTouser_profiles   program_checkins[]        @relation("program_checkins_teen_user_idTouser_profiles")
  program_sessions_program_sessions_closed_byTouser_profiles      program_sessions[]        @relation("program_sessions_closed_byTouser_profiles")
  program_sessions_program_sessions_opened_byTouser_profiles      program_sessions[]        @relation("program_sessions_opened_byTouser_profiles")
  user_ministries                                                 user_ministries[]
  user_notes_user_notes_created_byTouser_profiles                 user_notes[]              @relation("user_notes_created_byTouser_profiles")
  user_notes_user_notes_user_idTouser_profiles                    user_notes[]              @relation("user_notes_user_idTouser_profiles")
  people                                                          people?                   @relation(fields: [person_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user_sessions                                                   user_sessions[]
}

model user_sessions {
  id             String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id        String?        @db.Uuid
  device_info    String?        @db.VarChar(255)
  ip_address     String?        @db.VarChar(45)
  user_agent     String?
  last_active_at DateTime?      @default(now()) @db.Timestamp(6)
  created_at     DateTime?      @default(now()) @db.Timestamp(6)
  token_hash     String?        @db.VarChar(255)
  location       String?        @db.VarChar(150)
  user_profiles  user_profiles? @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "user_sessions_profile_id_fkey")
}
